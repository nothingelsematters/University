# Типовой расчёт 2

### Вариант 16

#### Задание 1

> Методом Монте-Карло оценить объем части тела заключённой в $k$-мерном кубе с ребром $[0, 1]$.
> Функция имеет вид $F(\overline x) = f(x_1) + f(x_2) + ... + f(x_k)$.
> Для выбранной надежности $\gamma \geqslant 0.95$ указать асимптотическую точность оценивания и построить асимптотический доверительный интервал для истинного
> значения объёма.
>
> Используя объем выборки $n = 10^4$ и $n=10^6$ оценить скорость сходимости и показать, что доверительные интервалы пересекаются.
>
> $f = \ln (ax + 1)$
> $k = 5$
> $c = 6.85$
> $a = 7$

```octave
pkg load statistics;

function I = interval(n, p, g)
  T = norminv((1 + g) / 2);
  d = T * sqrt(p * (1 - p) / n);
  I = [p - d, p + d];
endfunction

function run(n, k, c, g, f)
  x = rand(n, k);
  y = sum(f(x), 2);
  p = sum(y < c) / n;
  I = interval(n, p, g);
  printf("n=%d: p = %d, I = [%d, %d]\n", n, p, I)
endfunction

for n = [10 ^ 4, 10 ^ 6]
  run(n, 5, 6.85, 0.95, @(x) log(7 * x + 1));
endfor
```

| $n$    | $p$        | $I$                    |
| ------ | ---------- | ---------------------- |
| $10^4$ | $0.4614$   | $[0.451629, 0.471171]$ |
| $10^6$ | $0.467888$ | $[0.46691, 0.468866]$  |

Пересечение доверительных интегралов: доверительный интервал для $n = 10^6$ вложен в доверительный интервал при $n = 10^4$, поэтому интервалы пересекаются.

Оценка скорости сходимости: увеличив выборку в $100$ раз, доверительный интервал уменьшился в ${0.471171 - 0.451629 \over 0.468866 - 0.46691} \approx 9.990798$

#### Задание 2

> Аналогично построить оценку интегралов (представить интеграл как математическое ожидание функции, зависящей от случайной величины с известной плотностью) и для выбранной надежности $\gamma \geqslant 0.95$ указать асимптотическую точность оценивания и построить асимптотический доверительный интервал для истинного значения интеграла.

##### 2.a)

$\int_0^\infty x^4 \exp(-x)dx$

```octave
pkg load statistics;

g = 0.95;

function I = interval(approx, T, y, n)
    d = T * std(y) / sqrt(n);
    I = [approx - d, approx + d];
endfunction

function I = first(f, n, bottom, up, g)
    real = quad(f, bottom, up)
    x = exprnd(1, n, 1);
    y = x .^ 4;
    approx = mean(y)
    T = expinv((1 + g) / 2, 1);
    I = interval(approx, T, y, n)
endfunction

for n = [10 ^ 4, 10 ^ 6]
    n
    first(@(x) x .^ 4 .* exp(-x), n, 0, Inf, g);
endfor
```

$I_{real} = 24$

| n      | approx   | I                  |
| ------ | -------- | ------------------ |
| $10^4$ | $26.517$ | $[17.804, 25.230]$ |
| $10^6$ | $23.851$ | $[23.108, 24.594]$ |


Пересечение доверительных интегралов: доверительный интервал для $n = 10^6$ вложен в доверительный интервал при $n = 10^4$, поэтому интервалы пересекаются.

Оценка скорости сходимости: увеличив выборку в $100$ раз, доверительный интервал уменьшился в ${25.230 - 17.804  \over 24.594 - 23.108} \approx 4.997308$

##### 2.b)

$\int_{-\infty}^\infty \sqrt{|x|} \exp(-(x + 2)^2/4)dx$

```octave
pkg load statistics;

g = 0.95;

function I = interval(approx, T, y, n)
    d = T * std(y) / sqrt(n);
    I = [approx - d, approx + d];
endfunction

function I = second(f, n, bottom, up, g, a, s)
    real = quad(f, bottom, up)
    x = normrnd(a, s, n, 1);
    y = 2 * sqrt(pi * abs(x));
    approx = mean(y)
    T = norminv((1 + g) / 2);
    I = interval(approx, T, y, n)
endfunction

for n = [10 ^ 4, 10 ^ 6]
    n
    second(@(x) sqrt(abs(x)) .* exp(-(x + 2) ^ 2 / 4), n, -Inf, Inf, g, -2, sqrt(2));
endfor
```

$I_{real} = 4.8499$

| n      | approx   | I                  |
| ------ | -------- | ------------------ |
| $10^4$ | $4.8297$ | $[4.7965, 4.8629]$ |
| $10^6$ | $4.8499$ | $[4.8462, 4.8528]$ |

Пересечение доверительных интегралов: доверительный интервал для $n = 10^6$ вложен в доверительный интервал при $n = 10^4$, поэтому интервалы пересекаются.

Оценка скорости сходимости: увеличив выборку в $100$ раз, доверительный интервал уменьшился в ${4.8629 - 4.7965 \over 4.8528 - 4.8462} \approx 10.06060606$

